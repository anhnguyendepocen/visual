Ch4. Line graph
========================================================
변수 X에 대한 변수 Y의 값의 변화

### 4.1. Making a Basic Line Graph

Basic line graph :


```r
library(ggplot2)
BOD
```

```
##   Time demand
## 1    1    8.3
## 2    2   10.3
## 3    3   19.0
## 4    4   16.0
## 5    5   15.6
## 6    7   19.8
```

```r
ggplot(BOD, aes(x=Time, y=demand)) + geom_line()
```

![plot of chunk unnamed-chunk-1](figure/unnamed-chunk-1.png) 

When x is a categorical variable by converting it to a factor with factor() :


```r
BOD1 <- BOD # Make a copy of the data
BOD1$Time <- factor(BOD1$Time)

BOD1$Time
```

```
## [1] 1 2 3 4 5 7
## Levels: 1 2 3 4 5 7
```

```r
BOD$Time
```

```
## [1] 1 2 3 4 5 7
```

```r
ggplot(BOD1, aes(x=Time, y=demand, group=1)) + geom_line()
```

![plot of chunk unnamed-chunk-2](figure/unnamed-chunk-2.png) 

```r
#When the x variable is a factor, you must also use aes(group=1) to ensure that ggplot() knows that the data points belong together and should be connected with a line :
```


```r
ggplot(BOD, aes(x=Time, y=demand)) + geom_line() + ylim(0, max(BOD$demand))
```

![plot of chunk unnamed-chunk-3](figure/unnamed-chunk-3.png) 

```r
# These have the same result
# ggplot(BOD, aes(x=Time, y=demand)) + geom_line() + expand_limits(y=0)
```
### 4.2. Adding Points to a Line Graph

```r
ggplot(BOD, aes(x=Time, y=demand)) + geom_line() + geom_point()
```

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-41.png) 

```r
library(gcookbook)

ggplot(worldpop, aes(x=Year, y=Population)) + geom_line() + geom_point()
```

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-42.png) 

```r
ggplot(worldpop, aes(x=Year, y=Population)) + geom_line() + geom_point() +
scale_y_log10()
```

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-43.png) 

With the log y-axis, you can see that the rate of proportional change has increased in the last thousand years. We can also see that the population estimates are much more frequent in recent times—and probably more accurate!


### 4.3. Making a Line Graph with Multiple Lines

```r
# Load plyr so we can use ddply() to create the example data set
# ddply : Split data frame, apply function, and return results in a data frame

library(plyr)
ToothGrowth
```

```
##     len supp dose
## 1   4.2   VC  0.5
## 2  11.5   VC  0.5
## 3   7.3   VC  0.5
## 4   5.8   VC  0.5
## 5   6.4   VC  0.5
## 6  10.0   VC  0.5
## 7  11.2   VC  0.5
## 8  11.2   VC  0.5
## 9   5.2   VC  0.5
## 10  7.0   VC  0.5
## 11 16.5   VC  1.0
## 12 16.5   VC  1.0
## 13 15.2   VC  1.0
## 14 17.3   VC  1.0
## 15 22.5   VC  1.0
## 16 17.3   VC  1.0
## 17 13.6   VC  1.0
## 18 14.5   VC  1.0
## 19 18.8   VC  1.0
## 20 15.5   VC  1.0
## 21 23.6   VC  2.0
## 22 18.5   VC  2.0
## 23 33.9   VC  2.0
## 24 25.5   VC  2.0
## 25 26.4   VC  2.0
## 26 32.5   VC  2.0
## 27 26.7   VC  2.0
## 28 21.5   VC  2.0
## 29 23.3   VC  2.0
## 30 29.5   VC  2.0
## 31 15.2   OJ  0.5
## 32 21.5   OJ  0.5
## 33 17.6   OJ  0.5
## 34  9.7   OJ  0.5
## 35 14.5   OJ  0.5
## 36 10.0   OJ  0.5
## 37  8.2   OJ  0.5
## 38  9.4   OJ  0.5
## 39 16.5   OJ  0.5
## 40  9.7   OJ  0.5
## 41 19.7   OJ  1.0
## 42 23.3   OJ  1.0
## 43 23.6   OJ  1.0
## 44 26.4   OJ  1.0
## 45 20.0   OJ  1.0
## 46 25.2   OJ  1.0
## 47 25.8   OJ  1.0
## 48 21.2   OJ  1.0
## 49 14.5   OJ  1.0
## 50 27.3   OJ  1.0
## 51 25.5   OJ  2.0
## 52 26.4   OJ  2.0
## 53 22.4   OJ  2.0
## 54 24.5   OJ  2.0
## 55 24.8   OJ  2.0
## 56 30.9   OJ  2.0
## 57 26.4   OJ  2.0
## 58 27.3   OJ  2.0
## 59 29.4   OJ  2.0
## 60 23.0   OJ  2.0
```

```r
# Summarize the ToothGrowth data

tg <- ddply(ToothGrowth, c("supp", "dose"), summarise, length=mean(len))
tg
```

```
##   supp dose length
## 1   OJ  0.5  13.23
## 2   OJ  1.0  22.70
## 3   OJ  2.0  26.06
## 4   VC  0.5   7.98
## 5   VC  1.0  16.77
## 6   VC  2.0  26.14
```

```r
str(tg)
```

```
## 'data.frame':	6 obs. of  3 variables:
##  $ supp  : Factor w/ 2 levels "OJ","VC": 1 1 1 2 2 2
##  $ dose  : num  0.5 1 2 0.5 1 2
##  $ length: num  13.23 22.7 26.06 7.98 16.77 ...
```

```r
# Map supp to colour
ggplot(tg, aes(x=dose, y=length, colour=supp)) + geom_line()
```

![plot of chunk unnamed-chunk-5](figure/unnamed-chunk-51.png) 

```r
# Map supp to linetype
ggplot(tg, aes(x=dose, y=length, linetype=supp)) + geom_line()
```

![plot of chunk unnamed-chunk-5](figure/unnamed-chunk-52.png) 

```r
# the x-axis is conceived of as being categorical
ggplot(tg, aes(x=factor(dose), y=length, colour=supp, group=supp)) + geom_line()
```

![plot of chunk unnamed-chunk-5](figure/unnamed-chunk-53.png) 

```r
# without group=supp, error happen.
ggplot(tg, aes(x=factor(dose), y=length, colour=supp)) + geom_line()
```

```
## geom_path: Each group consist of only one observation. Do you need to adjust the group aesthetic?
```

![plot of chunk unnamed-chunk-5](figure/unnamed-chunk-54.png) 

```r
ggplot(tg, aes(x=dose, y=length)) + geom_line()
```

![plot of chunk unnamed-chunk-5](figure/unnamed-chunk-55.png) 

This happens because there are multiple data points at each y location, and ggplot() thinks they’re all in one group.


```r
ggplot(tg, aes(x=dose, y=length, shape=supp)) + geom_line() +
geom_point(size=4) # Make the points a little larger
```

![plot of chunk unnamed-chunk-6](figure/unnamed-chunk-61.png) 

```r
ggplot(tg, aes(x=dose, y=length, fill=supp)) + geom_line() +
geom_point(size=4, shape=21) # Also use a point with a color fill
```

![plot of chunk unnamed-chunk-6](figure/unnamed-chunk-62.png) 

```r
ggplot(tg, aes(x=dose, y=length, shape=supp)) +
geom_line(position=position_dodge(0.2)) + # Dodge lines by 0.2
geom_point(position=position_dodge(0.2), size=4) # Dodge points by 0.2
```

```
## ymax not defined: adjusting position using y instead
## ymax not defined: adjusting position using y instead
```

![plot of chunk unnamed-chunk-6](figure/unnamed-chunk-63.png) 
### 4.4. Changing the Appearance of Lines

```r
ggplot(tg, aes(x=dose, y=length, colour=supp)) +
geom_line() + scale_colour_brewer(palette="Set1")
```

![plot of chunk unnamed-chunk-7](figure/unnamed-chunk-71.png) 

```r
ggplot(tg, aes(x=dose, y=length, colour=supp)) +
geom_line(linetype="dashed") +
geom_point(shape=22, size=3, fill="white")
```

![plot of chunk unnamed-chunk-7](figure/unnamed-chunk-72.png) 
### 4.5. Changing the Appearance of Points

```r
ggplot(BOD, aes(x=Time, y=demand)) +
geom_line() +
geom_point(size=4, shape=22, colour="darkred", fill="pink")
```

![plot of chunk unnamed-chunk-8](figure/unnamed-chunk-81.png) 

```r
# The default shape for points is a solid circle, the default size is 2, and the default colour is "black".

# Summarize the ToothGrowth data
tg <- ddply(ToothGrowth, c("supp", "dose"), summarise, length=mean(len))

# Save the position_dodge specification because we'll use it multiple times

pd <- position_dodge(0.2)

ggplot(tg, aes(x=dose, y=length, fill=supp)) +
geom_line(position=pd) +
geom_point(shape=21, size=3, position=pd) +
scale_fill_manual(values=c("black","white"))
```

```
## ymax not defined: adjusting position using y instead
## ymax not defined: adjusting position using y instead
```

![plot of chunk unnamed-chunk-8](figure/unnamed-chunk-82.png) 

### 4.6. Making a Graph with a Shaded Area

Use geom_area() to get a shaded area.

```r
sunspot.year
```

```
## Time Series:
## Start = 1700 
## End = 1988 
## Frequency = 1 
##   [1]   5.0  11.0  16.0  23.0  36.0  58.0  29.0  20.0  10.0   8.0   3.0
##  [12]   0.0   0.0   2.0  11.0  27.0  47.0  63.0  60.0  39.0  28.0  26.0
##  [23]  22.0  11.0  21.0  40.0  78.0 122.0 103.0  73.0  47.0  35.0  11.0
##  [34]   5.0  16.0  34.0  70.0  81.0 111.0 101.0  73.0  40.0  20.0  16.0
##  [45]   5.0  11.0  22.0  40.0  60.0  80.9  83.4  47.7  47.8  30.7  12.2
##  [56]   9.6  10.2  32.4  47.6  54.0  62.9  85.9  61.2  45.1  36.4  20.9
##  [67]  11.4  37.8  69.8 106.1 100.8  81.6  66.5  34.8  30.6   7.0  19.8
##  [78]  92.5 154.4 125.9  84.8  68.1  38.5  22.8  10.2  24.1  82.9 132.0
##  [89] 130.9 118.1  89.9  66.6  60.0  46.9  41.0  21.3  16.0   6.4   4.1
## [100]   6.8  14.5  34.0  45.0  43.1  47.5  42.2  28.1  10.1   8.1   2.5
## [111]   0.0   1.4   5.0  12.2  13.9  35.4  45.8  41.1  30.1  23.9  15.6
## [122]   6.6   4.0   1.8   8.5  16.6  36.3  49.6  64.2  67.0  70.9  47.8
## [133]  27.5   8.5  13.2  56.9 121.5 138.3 103.2  85.7  64.6  36.7  24.2
## [144]  10.7  15.0  40.1  61.5  98.5 124.7  96.3  66.6  64.5  54.1  39.0
## [155]  20.6   6.7   4.3  22.7  54.8  93.8  95.8  77.2  59.1  44.0  47.0
## [166]  30.5  16.3   7.3  37.6  74.0 139.0 111.2 101.6  66.2  44.7  17.0
## [177]  11.3  12.4   3.4   6.0  32.3  54.3  59.7  63.7  63.5  52.2  25.4
## [188]  13.1   6.8   6.3   7.1  35.6  73.0  85.1  78.0  64.0  41.8  26.2
## [199]  26.7  12.1   9.5   2.7   5.0  24.4  42.0  63.5  53.8  62.0  48.5
## [210]  43.9  18.6   5.7   3.6   1.4   9.6  47.4  57.1 103.9  80.6  63.6
## [221]  37.6  26.1  14.2   5.8  16.7  44.3  63.9  69.0  77.8  64.9  35.7
## [232]  21.2  11.1   5.7   8.7  36.1  79.7 114.4 109.6  88.8  67.8  47.5
## [243]  30.6  16.3   9.6  33.2  92.6 151.6 136.3 134.7  83.9  69.4  31.5
## [254]  13.9   4.4  38.0 141.7 190.2 184.8 159.0 112.3  53.9  37.5  27.9
## [265]  10.2  15.1  47.0  93.8 105.9 105.5 104.5  66.6  68.9  38.0  34.5
## [276]  15.5  12.6  27.5  92.5 155.4 154.7 140.5 115.9  66.6  45.9  17.9
## [287]  13.4  29.2 100.2
```

```r
sunspotyear <- data.frame(Year = as.numeric(time(sunspot.year)),
Sunspots = as.numeric(sunspot.year))
head(sunspotyear)
```

```
##   Year Sunspots
## 1 1700        5
## 2 1701       11
## 3 1702       16
## 4 1703       23
## 5 1704       36
## 6 1705       58
```

```r
ggplot(sunspotyear, aes(x=Year, y=Sunspots)) + geom_area()
```

![plot of chunk unnamed-chunk-9](figure/unnamed-chunk-91.png) 

```r
# we will also make it 80% transparent by setting alpha to 0.2

ggplot(sunspotyear, aes(x=Year, y=Sunspots)) +
geom_area(colour="black", fill="blue", alpha=.2)
```

![plot of chunk unnamed-chunk-9](figure/unnamed-chunk-92.png) 

```r
# we can draw the area without an outline (by not specifying colour)

ggplot(sunspotyear, aes(x=Year, y=Sunspots)) +
geom_area(fill="blue", alpha=.2) + geom_line()
```

![plot of chunk unnamed-chunk-9](figure/unnamed-chunk-93.png) 

### 4.7. Making a Stacked Area Graph

```r
# Age distribution of population in the United States, 1900-2002
uspopage
```

```
##     Year AgeGroup Thousands
## 1   1900       <5      9181
## 2   1900     5-14     16966
## 3   1900    15-24     14951
## 4   1900    25-34     12161
## 5   1900    35-44      9273
## 6   1900    45-54      6437
## 7   1900    55-64      4026
## 8   1900      >64      3099
## 9   1901       <5      9336
## 10  1901     5-14     17158
## 11  1901    15-24     15242
## 12  1901    25-34     12442
## 13  1901    35-44      9504
## 14  1901    45-54      6606
## 15  1901    55-64      4122
## 16  1901      >64      3174
## 17  1902       <5      9502
## 18  1902     5-14     17360
## 19  1902    15-24     15555
## 20  1902    25-34     12737
## 21  1902    35-44      9745
## 22  1902    45-54      6788
## 23  1902    55-64      4220
## 24  1902      >64      3256
## 25  1903       <5      9645
## 26  1903     5-14     17524
## 27  1903    15-24     15858
## 28  1903    25-34     13019
## 29  1903    35-44      9974
## 30  1903    45-54      6964
## 31  1903    55-64      4313
## 32  1903      >64      3335
## 33  1904       <5      9791
## 34  1904     5-14     17697
## 35  1904    15-24     16178
## 36  1904    25-34     13315
## 37  1904    35-44     10211
## 38  1904    45-54      7150
## 39  1904    55-64      4410
## 40  1904      >64      3414
## 41  1905       <5      9944
## 42  1905     5-14     17888
## 43  1905    15-24     16526
## 44  1905    25-34     13631
## 45  1905    35-44     10461
## 46  1905    45-54      7350
## 47  1905    55-64      4517
## 48  1905      >64      3505
## 49  1906       <5     10092
## 50  1906     5-14     18067
## 51  1906    15-24     16864
## 52  1906    25-34     13952
## 53  1906    35-44     10705
## 54  1906    45-54      7554
## 55  1906    55-64      4621
## 56  1906      >64      3595
## 57  1907       <5     10220
## 58  1907     5-14     18240
## 59  1907    15-24     17184
## 60  1907    25-34     14257
## 61  1907    35-44     10945
## 62  1907    45-54      7755
## 63  1907    55-64      4724
## 64  1907      >64      3684
## 65  1908       <5     10364
## 66  1908     5-14     18440
## 67  1908    15-24     17526
## 68  1908    25-34     14585
## 69  1908    35-44     11202
## 70  1908    45-54      7974
## 71  1908    55-64      4840
## 72  1908      >64      3779
## 73  1909       <5     10509
## 74  1909     5-14     18670
## 75  1909    15-24     17871
## 76  1909    25-34     14923
## 77  1909    35-44     11471
## 78  1909    45-54      8204
## 79  1909    55-64      4964
## 80  1909      >64      3878
## 81  1910       <5     10671
## 82  1910     5-14     18950
## 83  1910    15-24     18212
## 84  1910    25-34     15274
## 85  1910    35-44     11759
## 86  1910    45-54      8454
## 87  1910    55-64      5101
## 88  1910      >64      3986
## 89  1911       <5     10796
## 90  1911     5-14     19214
## 91  1911    15-24     18355
## 92  1911    25-34     15530
## 93  1911    35-44     12003
## 94  1911    45-54      8657
## 95  1911    55-64      5234
## 96  1911      >64      4074
## 97  1912       <5     10915
## 98  1912     5-14     19503
## 99  1912    15-24     18477
## 100 1912    25-34     15772
## 101 1912    35-44     12252
## 102 1912    45-54      8875
## 103 1912    55-64      5372
## 104 1912      >64      4169
## 105 1913       <5     11082
## 106 1913     5-14     19904
## 107 1913    15-24     18649
## 108 1913    25-34     16070
## 109 1913    35-44     12562
## 110 1913    45-54      9135
## 111 1913    55-64      5542
## 112 1913      >64      4281
## 113 1914       <5     11244
## 114 1914     5-14     20316
## 115 1914    15-24     18796
## 116 1914    25-34     16370
## 117 1914    35-44     12875
## 118 1914    45-54      9398
## 119 1914    55-64      5711
## 120 1914      >64      4401
## 121 1915       <5     11347
## 122 1915     5-14     20660
## 123 1915    15-24     18844
## 124 1915    25-34     16580
## 125 1915    35-44     13130
## 126 1915    45-54      9618
## 127 1915    55-64      5866
## 128 1915      >64      4501
## 129 1916       <5     11442
## 130 1916     5-14     21008
## 131 1916    15-24     18872
## 132 1916    25-34     16776
## 133 1916    35-44     13388
## 134 1916    45-54      9846
## 135 1916    55-64      6026
## 136 1916      >64      4603
## 137 1917       <5     11527
## 138 1917     5-14     21369
## 139 1917    15-24     18836
## 140 1917    25-34     16913
## 141 1917    35-44     13647
## 142 1917    45-54     10068
## 143 1917    55-64      6194
## 144 1917      >64      4714
## 145 1918       <5     11606
## 146 1918     5-14     21732
## 147 1918    15-24     18071
## 148 1918    25-34     16445
## 149 1918    35-44     13879
## 150 1918    45-54     10293
## 151 1918    55-64      6356
## 152 1918      >64      4826
## 153 1919       <5     11536
## 154 1919     5-14     21849
## 155 1919    15-24     18465
## 156 1919    25-34     16912
## 157 1919    35-44     14008
## 158 1919    45-54     10402
## 159 1919    55-64      6456
## 160 1919      >64      4886
## 161 1920       <5     11631
## 162 1920     5-14     22158
## 163 1920    15-24     18821
## 164 1920    25-34     17416
## 165 1920    35-44     14382
## 166 1920    45-54     10505
## 167 1920    55-64      6619
## 168 1920      >64      4929
## 169 1921       <5     11879
## 170 1921     5-14     22515
## 171 1921    15-24     19140
## 172 1921    25-34     17747
## 173 1921    35-44     14665
## 174 1921    45-54     10721
## 175 1921    55-64      6791
## 176 1921      >64      5080
## 177 1922       <5     12031
## 178 1922     5-14     22788
## 179 1922    15-24     19402
## 180 1922    25-34     17924
## 181 1922    35-44     14823
## 182 1922    45-54     10899
## 183 1922    55-64      6951
## 184 1922      >64      5231
## 185 1923       <5     12119
## 186 1923     5-14     23089
## 187 1923    15-24     19798
## 188 1923    25-34     18231
## 189 1923    35-44     15066
## 190 1923    45-54     11068
## 191 1923    55-64      7165
## 192 1923      >64      5411
## 193 1924       <5     12269
## 194 1924     5-14     23358
## 195 1924    15-24     20314
## 196 1924    25-34     18557
## 197 1924    35-44     15337
## 198 1924    45-54     11278
## 199 1924    55-64      7387
## 200 1924      >64      5609
## 201 1925       <5     12316
## 202 1925     5-14     23614
## 203 1925    15-24     20691
## 204 1925    25-34     18720
## 205 1925    35-44     15576
## 206 1925    45-54     11521
## 207 1925    55-64      7605
## 208 1925      >64      5786
## 209 1926       <5     12189
## 210 1926     5-14     23906
## 211 1926    15-24     21037
## 212 1926    25-34     18867
## 213 1926    35-44     15847
## 214 1926    45-54     11786
## 215 1926    55-64      7805
## 216 1926      >64      5960
## 217 1927       <5     12111
## 218 1927     5-14     24152
## 219 1927    15-24     21430
## 220 1927    25-34     18948
## 221 1927    35-44     16172
## 222 1927    45-54     12092
## 223 1927    55-64      8003
## 224 1927      >64      6127
## 225 1928       <5     11978
## 226 1928     5-14     24320
## 227 1928    15-24     21811
## 228 1928    25-34     18953
## 229 1928    35-44     16540
## 230 1928    45-54     12430
## 231 1928    55-64      8178
## 232 1928      >64      6299
## 233 1929       <5     11734
## 234 1929     5-14     24470
## 235 1929    15-24     22151
## 236 1929    25-34     18941
## 237 1929    35-44     16921
## 238 1929    45-54     12761
## 239 1929    55-64      8315
## 240 1929      >64      6474
## 241 1930       <5     11372
## 242 1930     5-14     24631
## 243 1930    15-24     22487
## 244 1930    25-34     19039
## 245 1930    35-44     17270
## 246 1930    45-54     13096
## 247 1930    55-64      8477
## 248 1930      >64      6705
## 249 1931       <5     11179
## 250 1931     5-14     24629
## 251 1931    15-24     22617
## 252 1931    25-34     19242
## 253 1931    35-44     17412
## 254 1931    45-54     13296
## 255 1931    55-64      8735
## 256 1931      >64      6928
## 257 1932       <5     10903
## 258 1932     5-14     24614
## 259 1932    15-24     22716
## 260 1932    25-34     19484
## 261 1932    35-44     17504
## 262 1932    45-54     13481
## 263 1932    55-64      8992
## 264 1932      >64      7147
## 265 1933       <5     10612
## 266 1933     5-14     24531
## 267 1933    15-24     22820
## 268 1933    25-34     19750
## 269 1933    35-44     17569
## 270 1933    45-54     13684
## 271 1933    55-64      9249
## 272 1933      >64      7363
## 273 1934       <5     10331
## 274 1934     5-14     24402
## 275 1934    15-24     22963
## 276 1934    25-34     20022
## 277 1934    35-44     17640
## 278 1934    45-54     13933
## 279 1934    55-64      9502
## 280 1934      >64      7582
## 281 1935       <5     10170
## 282 1935     5-14     24213
## 283 1935    15-24     23130
## 284 1935    25-34     20275
## 285 1935    35-44     17712
## 286 1935    45-54     14208
## 287 1935    55-64      9739
## 288 1935      >64      7804
## 289 1936       <5     10044
## 290 1936     5-14     23942
## 291 1936    15-24     23309
## 292 1936    25-34     20505
## 293 1936    35-44     17783
## 294 1936    45-54     14495
## 295 1936    55-64      9949
## 296 1936      >64      8027
## 297 1937       <5     10009
## 298 1937     5-14     23564
## 299 1937    15-24     23487
## 300 1937    25-34     20723
## 301 1937    35-44     17866
## 302 1937    45-54     14785
## 303 1937    55-64     10132
## 304 1937      >64      8258
## 305 1938       <5     10176
## 306 1938     5-14     23146
## 307 1938    15-24     23655
## 308 1938    25-34     20953
## 309 1938    35-44     18001
## 310 1938    45-54     15077
## 311 1938    55-64     10310
## 312 1938      >64      8508
## 313 1939       <5     10418
## 314 1939     5-14     22701
## 315 1939    15-24     23819
## 316 1939    25-34     21176
## 317 1939    35-44     18178
## 318 1939    45-54     15336
## 319 1939    55-64     10487
## 320 1939      >64      8764
## 321 1940       <5     10579
## 322 1940     5-14     22363
## 323 1940    15-24     24033
## 324 1940    25-34     21446
## 325 1940    35-44     18422
## 326 1940    45-54     15555
## 327 1940    55-64     10694
## 328 1940      >64      9031
## 329 1941       <5     10850
## 330 1941     5-14     22089
## 331 1941    15-24     24074
## 332 1941    25-34     21691
## 333 1941    35-44     18692
## 334 1941    45-54     15759
## 335 1941    55-64     10959
## 336 1941      >64      9288
## 337 1942       <5     11301
## 338 1942     5-14     21823
## 339 1942    15-24     24093
## 340 1942    25-34     21911
## 341 1942    35-44     18950
## 342 1942    45-54     15976
## 343 1942    55-64     11220
## 344 1942      >64      9584
## 345 1943       <5     12016
## 346 1943     5-14     21699
## 347 1943    15-24     24065
## 348 1943    25-34     22194
## 349 1943    35-44     19226
## 350 1943    45-54     16199
## 351 1943    55-64     11472
## 352 1943      >64      9867
## 353 1944       <5     12524
## 354 1944     5-14     21573
## 355 1944    15-24     23999
## 356 1944    25-34     22511
## 357 1944    35-44     19505
## 358 1944    45-54     16419
## 359 1944    55-64     11719
## 360 1944      >64     10147
## 361 1945       <5     12979
## 362 1945     5-14     21599
## 363 1945    15-24     23705
## 364 1945    25-34     22734
## 365 1945    35-44     19787
## 366 1945    45-54     16642
## 367 1945    55-64     11988
## 368 1945      >64     10494
## 369 1946       <5     13244
## 370 1946     5-14     21844
## 371 1946    15-24     23382
## 372 1946    25-34     22954
## 373 1946    35-44     20073
## 374 1946    45-54     16820
## 375 1946    55-64     12244
## 376 1946      >64     10828
## 377 1947       <5     14406
## 378 1947     5-14     22257
## 379 1947    15-24     23122
## 380 1947    25-34     23236
## 381 1947    35-44     20421
## 382 1947    45-54     16970
## 383 1947    55-64     12528
## 384 1947      >64     11185
## 385 1948       <5     14919
## 386 1948     5-14     23089
## 387 1948    15-24     22866
## 388 1948    25-34     23494
## 389 1948    35-44     20794
## 390 1948    45-54     17107
## 391 1948    55-64     12824
## 392 1948      >64     11538
## 393 1949       <5     15607
## 394 1949     5-14     23770
## 395 1949    15-24     22570
## 396 1949    25-34     23729
## 397 1949    35-44     21187
## 398 1949    45-54     17260
## 399 1949    55-64     13145
## 400 1949      >64     11921
## 401 1950       <5     16331
## 402 1950     5-14     24477
## 403 1950    15-24     22260
## 404 1950    25-34     23932
## 405 1950    35-44     21557
## 406 1950    45-54     17400
## 407 1950    55-64     13364
## 408 1950      >64     12362
## 409 1951       <5     17252
## 410 1951     5-14     25055
## 411 1951    15-24     22018
## 412 1951    25-34     24085
## 413 1951    35-44     21833
## 414 1951    45-54     17623
## 415 1951    55-64     13654
## 416 1951      >64     12768
## 417 1952       <5     17228
## 418 1952     5-14     26656
## 419 1952    15-24     21796
## 420 1952    25-34     24197
## 421 1952    35-44     22109
## 422 1952    45-54     17881
## 423 1952    55-64     13918
## 424 1952      >64     13169
## 425 1953       <5     17548
## 426 1953     5-14     27880
## 427 1953    15-24     21658
## 428 1953    25-34     24233
## 429 1953    35-44     22359
## 430 1953    45-54     18171
## 431 1953    55-64     14135
## 432 1953      >64     13582
## 433 1954       <5     17962
## 434 1954     5-14     29092
## 435 1954    15-24     21641
## 436 1954    25-34     24233
## 437 1954    35-44     22571
## 438 1954    45-54     18501
## 439 1954    55-64     14350
## 440 1954      >64     14040
## 441 1955       <5     18467
## 442 1955     5-14     30248
## 443 1955    15-24     21667
## 444 1955    25-34     24175
## 445 1955    35-44     22818
## 446 1955    45-54     18824
## 447 1955    55-64     14586
## 448 1955      >64     14489
## 449 1956       <5     18895
## 450 1956     5-14     31423
## 451 1956    15-24     21869
## 452 1956    25-34     24015
## 453 1956    35-44     23160
## 454 1956    45-54     19143
## 455 1956    55-64     14815
## 456 1956      >64     14902
## 457 1957       <5     19379
## 458 1957     5-14     32515
## 459 1957    15-24     22311
## 460 1957    25-34     23737
## 461 1957    35-44     23496
## 462 1957    45-54     19513
## 463 1957    55-64     14973
## 464 1957      >64     15353
## 465 1958       <5     19768
## 466 1958     5-14     33322
## 467 1958    15-24     23162
## 468 1958    25-34     23430
## 469 1958    35-44     23693
## 470 1958    45-54     19857
## 471 1958    55-64     15139
## 472 1958      >64     15771
## 473 1959       <5     20175
## 474 1959     5-14     34564
## 475 1959    15-24     23988
## 476 1959    25-34     23169
## 477 1959    35-44     24023
## 478 1959    45-54     20262
## 479 1959    55-64     15401
## 480 1959      >64     16248
## 481 1960       <5     20341
## 482 1960     5-14     35735
## 483 1960    15-24     24576
## 484 1960    25-34     22919
## 485 1960    35-44     24221
## 486 1960    45-54     20578
## 487 1960    55-64     15625
## 488 1960      >64     16675
## 489 1961       <5     20522
## 490 1961     5-14     37031
## 491 1961    15-24     25242
## 492 1961    25-34     22692
## 493 1961    35-44     24392
## 494 1961    45-54     20875
## 495 1961    55-64     15847
## 496 1961      >64     17089
## 497 1962       <5     20469
## 498 1962     5-14     37435
## 499 1962    15-24     26909
## 500 1962    25-34     22494
## 501 1962    35-44     24519
## 502 1962    45-54     21124
## 503 1962    55-64     16131
## 504 1962      >64     17457
## 505 1963       <5     20342
## 506 1963     5-14     38124
## 507 1963    15-24     28223
## 508 1963    25-34     22410
## 509 1963    35-44     24584
## 510 1963    45-54     21346
## 511 1963    55-64     16436
## 512 1963      >64     17778
## 513 1964       <5     20165
## 514 1964     5-14     38783
## 515 1964    15-24     29519
## 516 1964    25-34     22396
## 517 1964    35-44     24562
## 518 1964    45-54     21580
## 519 1964    55-64     16758
## 520 1964      >64     18127
## 521 1965       <5     19824
## 522 1965     5-14     39426
## 523 1965    15-24     30773
## 524 1965    25-34     22465
## 525 1965    35-44     24447
## 526 1965    45-54     21839
## 527 1965    55-64     17077
## 528 1965      >64     18451
## 529 1966       <5     19208
## 530 1966     5-14     40051
## 531 1966    15-24     32012
## 532 1966    25-34     22725
## 533 1966    35-44     24276
## 534 1966    45-54     22125
## 535 1966    55-64     17408
## 536 1966      >64     18755
## 537 1967       <5     18563
## 538 1967     5-14     40496
## 539 1967    15-24     33196
## 540 1967    25-34     23156
## 541 1967    35-44     24038
## 542 1967    45-54     22440
## 543 1967    55-64     17752
## 544 1967      >64     19071
## 545 1968       <5     17913
## 546 1968     5-14     40772
## 547 1968    15-24     34090
## 548 1968    25-34     23990
## 549 1968    35-44     23731
## 550 1968    45-54     22758
## 551 1968    55-64     18088
## 552 1968      >64     19365
## 553 1969       <5     17376
## 554 1969     5-14     40884
## 555 1969    15-24     35236
## 556 1969    25-34     24681
## 557 1969    35-44     23383
## 558 1969    45-54     23047
## 559 1969    55-64     18390
## 560 1969      >64     19680
## 561 1970       <5     17166
## 562 1970     5-14     40772
## 563 1970    15-24     36535
## 564 1970    25-34     25323
## 565 1970    35-44     23150
## 566 1970    45-54     23317
## 567 1970    55-64     18682
## 568 1970      >64     20107
## 569 1971       <5     17244
## 570 1971     5-14     40490
## 571 1971    15-24     37948
## 572 1971    25-34     25958
## 573 1971    35-44     22978
## 574 1971    45-54     23519
## 575 1971    55-64     18963
## 576 1971      >64     20561
## 577 1972       <5     17101
## 578 1972     5-14     39946
## 579 1972    15-24     38449
## 580 1972    25-34     27623
## 581 1972    35-44     22859
## 582 1972    45-54     23687
## 583 1972    55-64     19211
## 584 1972      >64     21020
## 585 1973       <5     16851
## 586 1973     5-14     39309
## 587 1973    15-24     39240
## 588 1973    25-34     28939
## 589 1973    35-44     22810
## 590 1973    45-54     23807
## 591 1973    55-64     19428
## 592 1973      >64     21525
## 593 1974       <5     16487
## 594 1974     5-14     38716
## 595 1974    15-24     40017
## 596 1974    25-34     30225
## 597 1974    35-44     22826
## 598 1974    45-54     23809
## 599 1974    55-64     19713
## 600 1974      >64     22061
## 601 1975       <5     16121
## 602 1975     5-14     38240
## 603 1975    15-24     40812
## 604 1975    25-34     31471
## 605 1975    35-44     22831
## 606 1975    45-54     23756
## 607 1975    55-64     20045
## 608 1975      >64     22696
## 609 1976       <5     15617
## 610 1976     5-14     37759
## 611 1976    15-24     41520
## 612 1976    25-34     32759
## 613 1976    35-44     23093
## 614 1976    45-54     23622
## 615 1976    55-64     20386
## 616 1976      >64     23278
## 617 1977       <5     15564
## 618 1977     5-14     37034
## 619 1977    15-24     42039
## 620 1977    25-34     33998
## 621 1977    35-44     23563
## 622 1977    45-54     23370
## 623 1977    55-64     20780
## 624 1977      >64     23892
## 625 1978       <5     15735
## 626 1978     5-14     36220
## 627 1978    15-24     42442
## 628 1978    25-34     34963
## 629 1978    35-44     24437
## 630 1978    45-54     23174
## 631 1978    55-64     21112
## 632 1978      >64     24502
## 633 1979       <5     16063
## 634 1979     5-14     35392
## 635 1979    15-24     42699
## 636 1979    25-34     36203
## 637 1979    35-44     25176
## 638 1979    45-54     22942
## 639 1979    55-64     21448
## 640 1979      >64     25134
## 641 1980       <5     16451
## 642 1980     5-14     34839
## 643 1980    15-24     42497
## 644 1980    25-34     37429
## 645 1980    35-44     25805
## 646 1980    45-54     22743
## 647 1980    55-64     21754
## 648 1980      >64     25707
## 649 1981       <5     16893
## 650 1981     5-14     34360
## 651 1981    15-24     42204
## 652 1981    25-34     38900
## 653 1981    35-44     26394
## 654 1981    45-54     22580
## 655 1981    55-64     21913
## 656 1981      >64     26221
## 657 1982       <5     17228
## 658 1982     5-14     34103
## 659 1982    15-24     41644
## 660 1982    25-34     39418
## 661 1982    35-44     28030
## 662 1982    45-54     22425
## 663 1982    55-64     22030
## 664 1982      >64     26787
## 665 1983       <5     17547
## 666 1983     5-14     33922
## 667 1983    15-24     41020
## 668 1983    25-34     40208
## 669 1983    35-44     29267
## 670 1983    45-54     22356
## 671 1983    55-64     22112
## 672 1983      >64     27361
## 673 1984       <5     17695
## 674 1984     5-14     33788
## 675 1984    15-24     40460
## 676 1984    25-34     40962
## 677 1984    35-44     30503
## 678 1984    45-54     22386
## 679 1984    55-64     22155
## 680 1984      >64     27877
## 681 1985       <5     17842
## 682 1985     5-14     33692
## 683 1985    15-24     39992
## 684 1985    25-34     41696
## 685 1985    35-44     31691
## 686 1985    45-54     22460
## 687 1985    55-64     22135
## 688 1985      >64     28415
## 689 1986       <5     17963
## 690 1986     5-14     33572
## 691 1986    15-24     39557
## 692 1986    25-34     42372
## 693 1986    35-44     33009
## 694 1986    45-54     22659
## 695 1986    55-64     21994
## 696 1986      >64     29008
## 697 1987       <5     18052
## 698 1987     5-14     33807
## 699 1987    15-24     38890
## 700 1987    25-34     42841
## 701 1987    35-44     34227
## 702 1987    45-54     23096
## 703 1987    55-64     21751
## 704 1987      >64     29625
## 705 1988       <5     18195
## 706 1988     5-14     34255
## 707 1988    15-24     38151
## 708 1988    25-34     43130
## 709 1988    35-44     35181
## 710 1988    45-54     23949
## 711 1988    55-64     21513
## 712 1988      >64     30123
## 713 1989       <5     18508
## 714 1989     5-14     34714
## 715 1989    15-24     37391
## 716 1989    25-34     43236
## 717 1989    35-44     36415
## 718 1989    45-54     24633
## 719 1989    55-64     21241
## 720 1989      >64     30682
## 721 1990       <5     18856
## 722 1990     5-14     35290
## 723 1990    15-24     36922
## 724 1990    25-34     43216
## 725 1990    35-44     37783
## 726 1990    45-54     25207
## 727 1990    55-64     21102
## 728 1990      >64     31247
## 729 1991       <5     19208
## 730 1991     5-14     36037
## 731 1991    15-24     36504
## 732 1991    25-34     43224
## 733 1991    35-44     39329
## 734 1991    45-54     25820
## 735 1991    55-64     21046
## 736 1991      >64     31812
## 737 1992       <5     19528
## 738 1992     5-14     36677
## 739 1992    15-24     36434
## 740 1992    25-34     42997
## 741 1992    35-44     39976
## 742 1992    45-54     27548
## 743 1992    55-64     20998
## 744 1992      >64     32356
## 745 1993       <5     19729
## 746 1993     5-14     37367
## 747 1993    15-24     36464
## 748 1993    25-34     42653
## 749 1993    35-44     40912
## 750 1993    45-54     28864
## 751 1993    55-64     21028
## 752 1993      >64     32903
## 753 1994       <5     19777
## 754 1994     5-14     38026
## 755 1994    15-24     36532
## 756 1994    25-34     42330
## 757 1994    35-44     41819
## 758 1994    45-54     30153
## 759 1994    55-64     21159
## 760 1994      >64     33331
## 761 1995       <5     19627
## 762 1995     5-14     38645
## 763 1995    15-24     36674
## 764 1995    25-34     42052
## 765 1995    35-44     42711
## 766 1995    45-54     31480
## 767 1995    55-64     21320
## 768 1995      >64     33769
## 769 1996       <5     19408
## 770 1996     5-14     39296
## 771 1996    15-24     36797
## 772 1996    25-34     41809
## 773 1996    35-44     43552
## 774 1996    45-54     32800
## 775 1996    55-64     21590
## 776 1996      >64     34143
## 777 1997       <5     19233
## 778 1997     5-14     39855
## 779 1997    15-24     37308
## 780 1997    25-34     41345
## 781 1997    35-44     44229
## 782 1997    45-54     34178
## 783 1997    55-64     22099
## 784 1997      >64     34401
## 785 1998       <5     19145
## 786 1998     5-14     40335
## 787 1998    15-24     38007
## 788 1998    25-34     40757
## 789 1998    35-44     44748
## 790 1998    45-54     35232
## 791 1998    55-64     23011
## 792 1998      >64     34619
## 793 1999       <5     19136
## 794 1999     5-14     40819
## 795 1999    15-24     38676
## 796 1999    25-34     40178
## 797 1999    35-44     45077
## 798 1999    45-54     36578
## 799 1999    55-64     23778
## 800 1999      >64     34798
## 801 2000       <5     19212
## 802 2000     5-14     41077
## 803 2000    15-24     39357
## 804 2000    25-34     39857
## 805 2000    35-44     45154
## 806 2000    45-54     38052
## 807 2000    55-64     24436
## 808 2000      >64     35081
## 809 2001       <5     19364
## 810 2001     5-14     41118
## 811 2001    15-24     39982
## 812 2001    25-34     39815
## 813 2001    35-44     45141
## 814 2001    45-54     39228
## 815 2001    55-64     25315
## 816 2001      >64     35352
## 817 2002       <5     19609
## 818 2002     5-14     41037
## 819 2002    15-24     40590
## 820 2002    25-34     39928
## 821 2002    35-44     44917
## 822 2002    45-54     40084
## 823 2002    55-64     26602
## 824 2002      >64     35602
```

```r
str(uspopage)
```

```
## 'data.frame':	824 obs. of  3 variables:
##  $ Year     : int  1900 1900 1900 1900 1900 1900 1900 1900 1901 1901 ...
##  $ AgeGroup : Factor w/ 8 levels "<5","5-14","15-24",..: 1 2 3 4 5 6 7 8 1 2 ...
##  $ Thousands: int  9181 16966 14951 12161 9273 6437 4026 3099 9336 17158 ...
```

```r
ggplot(uspopage, aes(x=Year, y=Thousands, fill=AgeGroup)) + geom_area()
```

![plot of chunk unnamed-chunk-10](figure/unnamed-chunk-101.png) 

```r
# The default order of legend items is the opposite of the stacking order
# and adds thin(size=.2) lines between each area

ggplot(uspopage, aes(x=Year, y=Thousands, fill=AgeGroup)) +
geom_area(colour="black", size=.2, alpha=.4) +
scale_fill_brewer(palette="Blues", breaks=rev(levels(uspopage$AgeGroup)))
```

![plot of chunk unnamed-chunk-10](figure/unnamed-chunk-102.png) 

```r
# To reverse the stacking order, we put order=desc(AgeGroup) inside of aes()

ggplot(uspopage, aes(x=Year, y=Thousands, fill=AgeGroup, order=desc(AgeGroup))) + geom_area(colour="black", size=.2, alpha=.4) +
scale_fill_brewer(palette="Blues")
```

![plot of chunk unnamed-chunk-10](figure/unnamed-chunk-103.png) 

```r
# the outline includes the left and right sides.To get rid of it, first draw
# the stacked areas without an outline (by leaving colour as the default NA value), and then add a geom_line() on top:

ggplot(uspopage, aes(x=Year, y=Thousands, fill=AgeGroup, order=desc(AgeGroup))) + geom_area(colour=NA, alpha=.4) +
scale_fill_brewer(palette="Blues") +
geom_line(position="stack", size=.2)
```

```
## ymax not defined: adjusting position using y instead
```

![plot of chunk unnamed-chunk-10](figure/unnamed-chunk-104.png) 

### 4.8. Making a Proportional Stacked Area Graph


```r
# We use ddply() to split it into separate data frames for each value of Year, then apply the transform() function to each piece and calculate the Percent for each piece

uspopage_prop <- ddply(uspopage, "Year", transform,
Percent = Thousands / sum(Thousands) * 100)

head(uspopage_prop)
```

```
##   Year AgeGroup Thousands Percent
## 1 1900       <5      9181  12.065
## 2 1900     5-14     16966  22.296
## 3 1900    15-24     14951  19.648
## 4 1900    25-34     12161  15.982
## 5 1900    35-44      9273  12.186
## 6 1900    45-54      6437   8.459
```

```r
ggplot(uspopage_prop, aes(x=Year, y=Percent, fill=AgeGroup)) +
geom_area(colour="black", size=.2, alpha=.4) +
scale_fill_brewer(palette="Blues", breaks=rev(levels(uspopage$AgeGroup)))
```

![plot of chunk unnamed-chunk-11](figure/unnamed-chunk-11.png) 

### 4.9. Adding a Confidence Region

```r
head(climate)
```

```
##     Source Year Anomaly1y Anomaly5y Anomaly10y Unc10y
## 1 Berkeley 1800        NA        NA     -0.435  0.505
## 2 Berkeley 1801        NA        NA     -0.453  0.493
## 3 Berkeley 1802        NA        NA     -0.460  0.486
## 4 Berkeley 1803        NA        NA     -0.493  0.489
## 5 Berkeley 1804        NA        NA     -0.536  0.483
## 6 Berkeley 1805        NA        NA     -0.541  0.475
```

```r
clim <- subset(climate, Source == "Berkeley", select=c("Year", "Anomaly10y", "Unc10y"))

clim
```

```
##     Year Anomaly10y Unc10y
## 1   1800     -0.435  0.505
## 2   1801     -0.453  0.493
## 3   1802     -0.460  0.486
## 4   1803     -0.493  0.489
## 5   1804     -0.536  0.483
## 6   1805     -0.541  0.475
## 7   1806     -0.590  0.468
## 8   1807     -0.695  0.461
## 9   1808     -0.763  0.453
## 10  1809     -0.818  0.451
## 11  1810     -0.842  0.437
## 12  1811     -0.912  0.406
## 13  1812     -0.963  0.395
## 14  1813     -1.015  0.389
## 15  1814     -0.949  0.369
## 16  1815     -0.935  0.368
## 17  1816     -0.918  0.361
## 18  1817     -0.802  0.330
## 19  1818     -0.743  0.349
## 20  1819     -0.703  0.382
## 21  1820     -0.625  0.395
## 22  1821     -0.527  0.363
## 23  1822     -0.392  0.339
## 24  1823     -0.332  0.351
## 25  1824     -0.321  0.343
## 26  1825     -0.278  0.344
## 27  1826     -0.270  0.295
## 28  1827     -0.378  0.284
## 29  1828     -0.398  0.254
## 30  1829     -0.388  0.243
## 31  1830     -0.429  0.247
## 32  1831     -0.506  0.247
## 33  1832     -0.625  0.257
## 34  1833     -0.689  0.246
## 35  1834     -0.667  0.224
## 36  1835     -0.689  0.220
## 37  1836     -0.727  0.221
## 38  1837     -0.662  0.218
## 39  1838     -0.612  0.222
## 40  1839     -0.613  0.256
## 41  1840     -0.638  0.274
## 42  1841     -0.542  0.267
## 43  1842     -0.472  0.282
## 44  1843     -0.407  0.269
## 45  1844     -0.402  0.285
## 46  1845     -0.390  0.285
## 47  1846     -0.351  0.284
## 48  1847     -0.346  0.280
## 49  1848     -0.362  0.273
## 50  1849     -0.357  0.260
## 51  1850     -0.290  0.244
## 52  1851     -0.321  0.239
## 53  1852     -0.372  0.228
## 54  1853     -0.363  0.226
## 55  1854     -0.351  0.228
## 56  1855     -0.348  0.216
## 57  1856     -0.374  0.203
## 58  1857     -0.418  0.187
## 59  1858     -0.420  0.186
## 60  1859     -0.427  0.178
## 61  1860     -0.473  0.172
## 62  1861     -0.458  0.154
## 63  1862     -0.412  0.149
## 64  1863     -0.393  0.145
## 65  1864     -0.373  0.141
## 66  1865     -0.344  0.148
## 67  1866     -0.317  0.147
## 68  1867     -0.282  0.145
## 69  1868     -0.269  0.145
## 70  1869     -0.241  0.149
## 71  1870     -0.233  0.149
## 72  1871     -0.255  0.146
## 73  1872     -0.271  0.142
## 74  1873     -0.247  0.140
## 75  1874     -0.248  0.132
## 76  1875     -0.271  0.128
## 77  1876     -0.252  0.124
## 78  1877     -0.235  0.120
## 79  1878     -0.257  0.115
## 80  1879     -0.297  0.119
## 81  1880     -0.321  0.124
## 82  1881     -0.314  0.123
## 83  1882     -0.325  0.117
## 84  1883     -0.376  0.108
## 85  1884     -0.373  0.111
## 86  1885     -0.368  0.110
## 87  1886     -0.386  0.109
## 88  1887     -0.397  0.107
## 89  1888     -0.394  0.108
## 90  1889     -0.364  0.104
## 91  1890     -0.342  0.102
## 92  1891     -0.323  0.099
## 93  1892     -0.298  0.100
## 94  1893     -0.273  0.107
## 95  1894     -0.286  0.107
## 96  1895     -0.251  0.106
## 97  1896     -0.201  0.104
## 98  1897     -0.176  0.104
## 99  1898     -0.153  0.104
## 100 1899     -0.174  0.106
## 101 1900     -0.171  0.108
## 102 1901     -0.162  0.109
## 103 1902     -0.177  0.108
## 104 1903     -0.199  0.104
## 105 1904     -0.223  0.105
## 106 1905     -0.241  0.107
## 107 1906     -0.294  0.106
## 108 1907     -0.312  0.105
## 109 1908     -0.328  0.103
## 110 1909     -0.281  0.101
## 111 1910     -0.247  0.099
## 112 1911     -0.243  0.097
## 113 1912     -0.257  0.100
## 114 1913     -0.268  0.100
## 115 1914     -0.257  0.097
## 116 1915     -0.249  0.095
## 117 1916     -0.214  0.096
## 118 1917     -0.201  0.096
## 119 1918     -0.176  0.096
## 120 1919     -0.182  0.097
## 121 1920     -0.193  0.097
## 122 1921     -0.167  0.098
## 123 1922     -0.128  0.096
## 124 1923     -0.075  0.097
## 125 1924     -0.064  0.098
## 126 1925     -0.065  0.100
## 127 1926     -0.050  0.100
## 128 1927     -0.020  0.099
## 129 1928     -0.018  0.099
## 130 1929     -0.026  0.100
## 131 1930     -0.014  0.101
## 132 1931     -0.047  0.098
## 133 1932     -0.035  0.096
## 134 1933     -0.017  0.093
## 135 1934      0.020  0.092
## 136 1935      0.053  0.089
## 137 1936      0.063  0.085
## 138 1937      0.048  0.081
## 139 1938      0.073  0.079
## 140 1939      0.113  0.076
## 141 1940      0.113  0.072
## 142 1941      0.134  0.071
## 143 1942      0.134  0.069
## 144 1943      0.127  0.070
## 145 1944      0.111  0.068
## 146 1945      0.072  0.066
## 147 1946      0.035  0.066
## 148 1947      0.042  0.064
## 149 1948      0.045  0.063
## 150 1949      0.013  0.062
## 151 1950      0.010  0.058
## 152 1951     -0.017  0.054
## 153 1952     -0.040  0.047
## 154 1953     -0.040  0.043
## 155 1954     -0.032  0.038
## 156 1955     -0.022  0.035
## 157 1956      0.012  0.031
## 158 1957      0.007  0.028
## 159 1958      0.002  0.027
## 160 1959      0.002  0.026
## 161 1960     -0.019  0.026
## 162 1961     -0.001  0.021
## 163 1962      0.017  0.018
## 164 1963      0.004  0.016
## 165 1964     -0.028  0.018
## 166 1965     -0.006  0.017
## 167 1966     -0.024  0.017
## 168 1967     -0.041  0.019
## 169 1968     -0.025  0.020
## 170 1969     -0.019  0.024
## 171 1970      0.010  0.026
## 172 1971      0.007  0.022
## 173 1972      0.015  0.015
## 174 1973      0.028  0.012
## 175 1974      0.049  0.014
## 176 1975      0.068  0.012
## 177 1976      0.128  0.011
## 178 1977      0.158  0.012
## 179 1978      0.167  0.013
## 180 1979      0.193  0.012
## 181 1980      0.186  0.016
## 182 1981      0.217  0.016
## 183 1982      0.235  0.014
## 184 1983      0.270  0.014
## 185 1984      0.318  0.014
## 186 1985      0.344  0.013
## 187 1986      0.352  0.012
## 188 1987      0.380  0.011
## 189 1988      0.370  0.013
## 190 1989      0.366  0.017
## 191 1990      0.433  0.019
## 192 1991      0.467  0.018
## 193 1992      0.496  0.017
## 194 1993      0.526  0.019
## 195 1994      0.554  0.020
## 196 1995      0.563  0.019
## 197 1996      0.565  0.022
## 198 1997      0.618  0.022
## 199 1998      0.680  0.023
## 200 1999      0.734  0.025
## 201 2000      0.748  0.026
## 202 2001      0.793  0.027
## 203 2002      0.856  0.028
## 204 2003      0.869  0.028
## 205 2004      0.884  0.029
```

```r
# In the climate data set, Anomaly10y is a 10-year running average of the 
# deviation (in Celsius) from the average 1950~1980 temperature, and Unc10y is the 95% confidence interval.

# Ribbons, y range with continuous x values.

ggplot(clim, aes(x=Year, y=Anomaly10y)) +
geom_ribbon(aes(ymin=Anomaly10y-Unc10y, ymax=Anomaly10y+Unc10y),
alpha=0.2) + geom_line()
```

![plot of chunk unnamed-chunk-12](figure/unnamed-chunk-121.png) 

```r
# With a dotted line for upper and lower bounds

ggplot(clim, aes(x=Year, y=Anomaly10y)) +
geom_line(aes(y=Anomaly10y-Unc10y), colour="grey50", linetype="dotted") +
geom_line(aes(y=Anomaly10y+Unc10y), colour="grey50", linetype="dotted") +
geom_line()
```

![plot of chunk unnamed-chunk-12](figure/unnamed-chunk-122.png) 
